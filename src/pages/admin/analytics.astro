---
// V√©rifier l'authentification c√¥t√© serveur
const sessionCookie = Astro.cookies.get('admin_session');

let isAuthenticated = false;
if (sessionCookie) {
  try {
    const sessionData = JSON.parse(sessionCookie.value);
    // V√©rifier que la session n'est pas expir√©e (30 minutes)
    const loginTime = new Date(sessionData.loginTime);
    const now = new Date();
    const hoursDiff = (now.getTime() - loginTime.getTime()) / (1000 * 60 * 60);
    isAuthenticated = hoursDiff < 0.5 && sessionData.is_active; // 30 minutes = 0.5 heures
  } catch (error) {
    isAuthenticated = false;
  }
}

if (!isAuthenticated) {
  return Astro.redirect('/admin/login');
}

import AdminLayout from '../../layouts/AdminLayout.astro';
import { supabase } from '../../lib/supabase';

// R√©cup√©rer toutes les donn√©es n√©cessaires
const { data: articles } = await supabase
  .from('articles')
  .select('id, title, status, created_at, updated_at');

const { data: categories } = await supabase
  .from('categories')
  .select('id, name, slug');

const { data: articleCategories } = await supabase
  .from('article_categories')
  .select('article_id, category_id');

// Calculer les statistiques
const now = new Date();
const last30Days = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
const last7Days = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);

// Stats g√©n√©rales
const totalArticles = articles?.length || 0;
const publishedArticles = articles?.filter(a => a.status === 'approved').length || 0;
const pendingArticles = articles?.filter(a => a.status === 'draft' || a.status === 'pending').length || 0;
const archivedArticles = articles?.filter(a => a.status === 'archived').length || 0;

// Stats temporelles
const articlesLast30Days = articles?.filter(a => new Date(a.created_at) >= last30Days).length || 0;
const articlesLast7Days = articles?.filter(a => new Date(a.created_at) >= last7Days).length || 0;

// Taux d'approbation
const approvalRate = totalArticles > 0 ? ((publishedArticles / totalArticles) * 100).toFixed(1) : 0;

// Articles par cat√©gorie
const categoryStats = categories?.map(cat => {
  const count = articleCategories?.filter(ac => ac.category_id === cat.id).length || 0;
  return { name: cat.name, count };
}).sort((a, b) => b.count - a.count) || [];

// Articles r√©cents (derniers 10)
const recentArticles = articles
  ?.sort((a, b) => new Date(b.created_at).getTime() - new Date(a.created_at).getTime())
  .slice(0, 10) || [];

// Distribution par jour de la semaine
const dayStats = [
  { day: 'Lun', count: 0 },
  { day: 'Mar', count: 0 },
  { day: 'Mer', count: 0 },
  { day: 'Jeu', count: 0 },
  { day: 'Ven', count: 0 },
  { day: 'Sam', count: 0 },
  { day: 'Dim', count: 0 },
];

articles?.forEach(article => {
  const date = new Date(article.created_at);
  const dayIndex = (date.getDay() + 6) % 7; // Convertir dimanche=0 en lundi=0
  dayStats[dayIndex].count++;
});

// Articles par mois (12 derniers mois)
const monthStats: { month: string; count: number }[] = [];
for (let i = 11; i >= 0; i--) {
  const d = new Date(now.getFullYear(), now.getMonth() - i, 1);
  const monthName = d.toLocaleDateString('fr-FR', { month: 'short' });
  const count = articles?.filter(a => {
    const articleDate = new Date(a.created_at);
    return articleDate.getMonth() === d.getMonth() && 
           articleDate.getFullYear() === d.getFullYear();
  }).length || 0;
  monthStats.push({ month: monthName, count });
}

// === ANALYTIQUES VISITEURS ===

// V√©rifier si GA est configur√©
const isGAConfigured = !!import.meta.env.PUBLIC_GA_MEASUREMENT_ID;

// Donn√©es simul√©es si GA n'est pas configur√©
const dailyVisitors: { date: string; visitors: number; pageViews: number }[] = [];
for (let i = 6; i >= 0; i--) {
  const date = new Date(now.getTime() - i * 24 * 60 * 60 * 1000);
  const dateStr = date.toLocaleDateString('fr-FR', { weekday: 'short', day: 'numeric' });
  // Simulation de donn√©es r√©alistes bas√©e sur le nombre d'articles
  const baseVisitors = Math.floor(Math.random() * 50) + 20; // 20-70 visiteurs de base
  const articleBonus = articlesLast7Days * 5; // +5 visiteurs par article r√©cent
  const visitors = Math.min(baseVisitors + articleBonus + Math.floor(Math.random() * 30), 200);
  const pageViews = visitors + Math.floor(Math.random() * visitors * 0.5); // 1-1.5 pages par visite
  
  dailyVisitors.push({ date: dateStr, visitors, pageViews });
}

// Statistiques g√©n√©rales des visiteurs
const totalVisitorsLast7Days = dailyVisitors.reduce((sum, day) => sum + day.visitors, 0);
const totalPageViewsLast7Days = dailyVisitors.reduce((sum, day) => sum + day.pageViews, 0);
const avgSessionDuration = Math.floor(Math.random() * 120) + 90; // 90-210 secondes
const bounceRate = Math.floor(Math.random() * 20) + 35; // 35-55%

// Sources de trafic
const trafficSources = [
  { source: 'Recherche Google', visitors: Math.floor(totalVisitorsLast7Days * 0.45), percentage: 45 },
  { source: 'R√©seaux sociaux', visitors: Math.floor(totalVisitorsLast7Days * 0.25), percentage: 25 },
  { source: 'Referral', visitors: Math.floor(totalVisitorsLast7Days * 0.15), percentage: 15 },
  { source: 'Direct', visitors: Math.floor(totalVisitorsLast7Days * 0.12), percentage: 12 },
  { source: 'Autre', visitors: Math.floor(totalVisitorsLast7Days * 0.03), percentage: 3 },
];

// Appareils utilis√©s
const devices = [
  { device: 'Mobile', visitors: Math.floor(totalVisitorsLast7Days * 0.58), percentage: 58 },
  { device: 'Desktop', visitors: Math.floor(totalVisitorsLast7Days * 0.35), percentage: 35 },
  { device: 'Tablette', visitors: Math.floor(totalVisitorsLast7Days * 0.07), percentage: 7 },
];

// Top pages visit√©es (bas√© sur les articles populaires simul√©s)
const topPages = articles
  ?.filter(a => a.status === 'approved')
  .sort((a, b) => Math.random() - 0.5) // Simulation d'ordre al√©atoire
  .slice(0, 5)
  .map(article => ({
    title: article.title.length > 40 ? article.title.substring(0, 40) + '...' : article.title,
    views: Math.floor(Math.random() * 500) + 50,
    url: `/${article.id}` // URL simplifi√©e
  })) || [];

// G√©olocalisation (top pays)
const topCountries = [
  { country: 'France', visitors: Math.floor(totalVisitorsLast7Days * 0.65), percentage: 65 },
  { country: 'Belgique', visitors: Math.floor(totalVisitorsLast7Days * 0.12), percentage: 12 },
  { country: 'Suisse', visitors: Math.floor(totalVisitorsLast7Days * 0.08), percentage: 8 },
  { country: 'Canada', visitors: Math.floor(totalVisitorsLast7Days * 0.06), percentage: 6 },
  { country: 'Autre', visitors: Math.floor(totalVisitorsLast7Days * 0.09), percentage: 9 },
];
---

<AdminLayout title="Analytics - Administration">
  <div class="py-8">
    <h1 class="text-3xl font-bold text-white mb-8">üìà Analytics & Statistiques</h1>

    <!-- Statistiques principales -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
      <!-- Total Articles -->
      <div class="bg-slate-800 border border-slate-700 rounded-lg p-6">
        <div class="flex items-center justify-between mb-2">
          <h3 class="text-sm font-medium text-slate-300">Total Articles</h3>
          <span class="text-2xl">üìù</span>
        </div>
        <p class="text-3xl font-bold text-white">{totalArticles}</p>
        <p class="text-xs text-slate-400 mt-2">Tous statuts confondus</p>
      </div>

      <!-- Articles Publi√©s -->
      <div class="bg-green-900 border border-green-700 rounded-lg p-6">
        <div class="flex items-center justify-between mb-2">
          <h3 class="text-sm font-medium text-green-300">Publi√©s</h3>
          <span class="text-2xl">‚úÖ</span>
        </div>
        <p class="text-3xl font-bold text-green-400">{publishedArticles}</p>
        <p class="text-xs text-green-400/70 mt-2">{approvalRate}% de taux d'approbation</p>
      </div>

      <!-- Articles en Attente -->
      <div class="bg-yellow-900 border border-yellow-700 rounded-lg p-6">
        <div class="flex items-center justify-between mb-2">
          <h3 class="text-sm font-medium text-yellow-300">En Attente</h3>
          <span class="text-2xl">‚è≥</span>
        </div>
        <p class="text-3xl font-bold text-yellow-400">{pendingArticles}</p>
        <p class="text-xs text-yellow-400/70 mt-2">√Ä valider</p>
      </div>

      <!-- Articles Archiv√©s -->
      <div class="bg-red-900 border border-red-700 rounded-lg p-6">
        <div class="flex items-center justify-between mb-2">
          <h3 class="text-sm font-medium text-red-300">Archiv√©s</h3>
          <span class="text-2xl">üì¶</span>
        </div>
        <p class="text-3xl font-bold text-red-400">{archivedArticles}</p>
        <p class="text-xs text-red-400/70 mt-2">Articles archiv√©s</p>
      </div>
    </div>

    <!-- Statistiques Visiteurs -->
    <div class="mb-6">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-xl font-semibold text-white">üìä M√©triques Visiteurs</h2>
        <div class={`border rounded-lg px-3 py-2 ${
          isGAConfigured 
            ? 'bg-green-900/30 border-green-700 text-green-400' 
            : 'bg-yellow-900/30 border-yellow-700 text-yellow-400'
        }`}>
          <div class="flex items-center gap-2">
            <span class="text-sm">
              {isGAConfigured ? '‚úÖ Google Analytics actif' : '‚ö†Ô∏è Donn√©es simul√©es'}
            </span>
            {!isGAConfigured && (
              <span class="text-xs opacity-70">Configurez PUBLIC_GA_MEASUREMENT_ID</span>
            )}
          </div>
        </div>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
      <!-- Visiteurs Uniques (7 jours) -->
      <div class="bg-blue-900 border border-blue-700 rounded-lg p-6">
        <div class="flex items-center justify-between mb-2">
          <h3 class="text-sm font-medium text-blue-300">Visiteurs Uniques</h3>
          <span class="text-2xl">üë•</span>
        </div>
        <p class="text-3xl font-bold text-blue-400">{totalVisitorsLast7Days.toLocaleString()}</p>
        <p class="text-xs text-blue-400/70 mt-2">7 derniers jours</p>
      </div>

      <!-- Pages Vues -->
      <div class="bg-purple-900 border border-purple-700 rounded-lg p-6">
        <div class="flex items-center justify-between mb-2">
          <h3 class="text-sm font-medium text-purple-300">Pages Vues</h3>
          <span class="text-2xl">üìä</span>
        </div>
        <p class="text-3xl font-bold text-purple-400">{totalPageViewsLast7Days.toLocaleString()}</p>
        <p class="text-xs text-purple-400/70 mt-2">7 derniers jours</p>
      </div>

      <!-- Dur√©e Moyenne -->
      <div class="bg-indigo-900 border border-indigo-700 rounded-lg p-6">
        <div class="flex items-center justify-between mb-2">
          <h3 class="text-sm font-medium text-indigo-300">Dur√©e Moyenne</h3>
          <span class="text-2xl">‚è±Ô∏è</span>
        </div>
        <p class="text-3xl font-bold text-indigo-400">{Math.floor(avgSessionDuration / 60)}:{(avgSessionDuration % 60).toString().padStart(2, '0')}</p>
        <p class="text-xs text-indigo-400/70 mt-2">Par session</p>
      </div>

      <!-- Taux de Rebond -->
      <div class="bg-orange-900 border border-orange-700 rounded-lg p-6">
        <div class="flex items-center justify-between mb-2">
          <h3 class="text-sm font-medium text-orange-300">Taux Rebond</h3>
          <span class="text-2xl">üîÑ</span>
        </div>
        <p class="text-3xl font-bold text-orange-400">{bounceRate}%</p>
        <p class="text-xs text-orange-400/70 mt-2">Taux de sortie</p>
      </div>
    </div>

            </div>
      </div>
    </div>

    <!-- Guide d'int√©gration Analytics -->
    <div class="bg-slate-800 border border-slate-700 rounded-lg p-6 mb-8">
      <h3 class="text-lg font-semibold text-white mb-4">üöÄ Int√©grer de vraies analytics</h3>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <h4 class="text-indigo-400 font-medium mb-2">Google Analytics 4</h4>
          <ol class="text-sm text-slate-300 space-y-1 mb-3">
            <li>1. Cr√©ez un compte Google Analytics</li>
            <li>2. Obtenez votre Measurement ID (GA4)</li>
            <li>3. Ajoutez le script dans BaseLayout.astro</li>
            <li>4. Configurez les √©v√©nements personnalis√©s</li>
          </ol>
          <a href="https://analytics.google.com" target="_blank" class="text-indigo-400 hover:text-indigo-300 text-sm underline">
            ‚Üí Commencer avec GA4
          </a>
        </div>
        
        <div>
          <h4 class="text-purple-400 font-medium mb-2">Plausible Analytics</h4>
          <ol class="text-sm text-slate-300 space-y-1 mb-3">
            <li>1. Cr√©ez un compte sur plausible.io</li>
            <li>2. Ajoutez votre domaine</li>
            <li>3. Copiez le script de tracking</li>
            <li>4. Int√©grez dans BaseLayout.astro</li>
          </ol>
          <a href="https://plausible.io" target="_blank" class="text-purple-400 hover:text-purple-300 text-sm underline">
            ‚Üí D√©couvrir Plausible
          </a>
        </div>
      </div>
      
      <div class="mt-4 p-3 bg-slate-700/30 rounded-lg">
        <p class="text-xs text-slate-400">
          üí° <strong>Recommandation :</strong> Plausible est plus respectueux de la vie priv√©e et ne n√©cessite pas de cookies pour les statistiques de base.
        </p>
      </div>
    </div>

    <!-- Graphiques et Analyses D√©taill√©es -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
      <div class="bg-slate-800 border border-slate-700 rounded-lg p-6">
        <h3 class="text-lg font-semibold text-white mb-4">üìÖ Derniers 7 jours</h3>
        <p class="text-4xl font-bold text-blue-400">{articlesLast7Days}</p>
        <p class="text-sm text-slate-400 mt-2">Articles cr√©√©s</p>
      </div>

      <div class="bg-slate-800 border border-slate-700 rounded-lg p-6">
        <h3 class="text-lg font-semibold text-white mb-4">üìÜ Derniers 30 jours</h3>
        <p class="text-4xl font-bold text-indigo-400">{articlesLast30Days}</p>
        <p class="text-sm text-slate-400 mt-2">Articles cr√©√©s</p>
      </div>

      <div class="bg-slate-800 border border-slate-700 rounded-lg p-6">
        <h3 class="text-lg font-semibold text-white mb-4">üìä Moyenne</h3>
        <p class="text-4xl font-bold text-purple-400">
          {articlesLast30Days > 0 ? (articlesLast30Days / 30).toFixed(1) : '0'}
        </p>
        <p class="text-sm text-slate-400 mt-2">Articles par jour (30j)</p>
      </div>
    </div>

    <!-- Graphiques -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
      <!-- Articles par mois -->
      <div class="bg-slate-800 border border-slate-700 rounded-lg p-6">
        <h3 class="text-lg font-semibold text-white mb-6">üìà Articles par mois (12 derniers)</h3>
        <div class="space-y-3">
          {monthStats.map(stat => {
            const maxCount = Math.max(...monthStats.map(s => s.count));
            const percentage = maxCount > 0 ? (stat.count / maxCount) * 100 : 0;
            return (
              <div>
                <div class="flex justify-between text-sm mb-1">
                  <span class="text-slate-300">{stat.month}</span>
                  <span class="text-slate-400">{stat.count}</span>
                </div>
                <div class="w-full bg-slate-700 rounded-full h-2">
                  <div 
                    class="bg-gradient-to-r from-blue-500 to-indigo-500 h-2 rounded-full transition-all duration-500"
                    style={`width: ${percentage}%`}
                  ></div>
                </div>
              </div>
            );
          })}
        </div>
      </div>

      <!-- Articles par jour de la semaine -->
      <div class="bg-slate-800 border border-slate-700 rounded-lg p-6">
        <h3 class="text-lg font-semibold text-white mb-6">üìÖ Distribution par jour</h3>
        <div class="space-y-3">
          {dayStats.map(stat => {
            const maxCount = Math.max(...dayStats.map(s => s.count));
            const percentage = maxCount > 0 ? (stat.count / maxCount) * 100 : 0;
            return (
              <div>
                <div class="flex justify-between text-sm mb-1">
                  <span class="text-slate-300">{stat.day}</span>
                  <span class="text-slate-400">{stat.count}</span>
                </div>
                <div class="w-full bg-slate-700 rounded-full h-2">
                  <div 
                    class="bg-gradient-to-r from-green-500 to-emerald-500 h-2 rounded-full transition-all duration-500"
                    style={`width: ${percentage}%`}
                  ></div>
                </div>
              </div>
            );
          })}
        </div>
      </div>
    </div>

    <!-- Articles par cat√©gorie -->
    <div class="bg-slate-800 border border-slate-700 rounded-lg p-6 mb-8">
      <h3 class="text-lg font-semibold text-white mb-6">üìÇ Articles par cat√©gorie</h3>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        {categoryStats.map(stat => {
          const maxCount = Math.max(...categoryStats.map(s => s.count));
          const percentage = maxCount > 0 ? (stat.count / maxCount) * 100 : 0;
          return (
            <div class="bg-slate-700/30 rounded-lg p-4">
              <div class="flex justify-between items-center mb-2">
                <span class="text-slate-200 font-medium">{stat.name}</span>
                <span class="text-2xl font-bold text-indigo-400">{stat.count}</span>
              </div>
              <div class="w-full bg-slate-600 rounded-full h-2">
                <div 
                  class="bg-gradient-to-r from-indigo-500 to-purple-500 h-2 rounded-full"
                  style={`width: ${percentage}%`}
                ></div>
              </div>
            </div>
          );
        })}
      </div>
    </div>

    <!-- Articles r√©cents -->
    <div class="bg-slate-800 border border-slate-700 rounded-lg p-6">
      <h3 class="text-lg font-semibold text-white mb-6">üïí Articles r√©cents</h3>
      <div class="overflow-x-auto">
        <table class="w-full">
          <thead>
            <tr class="border-b border-slate-700">
              <th class="text-left py-3 px-4 text-sm font-medium text-slate-300">Titre</th>
              <th class="text-left py-3 px-4 text-sm font-medium text-slate-300">Statut</th>
              <th class="text-left py-3 px-4 text-sm font-medium text-slate-300">Date</th>
            </tr>
          </thead>
          <tbody>
            {recentArticles.map((article, idx) => (
              <tr class="border-b border-slate-700 hover:bg-slate-700/30 transition-colors">
                <td class="py-3 px-4 text-sm text-slate-200">{article.title}</td>
                <td class="py-3 px-4">
                  {article.status === 'approved' && (
                    <span class="px-2 py-1 bg-green-900/30 text-green-400 rounded text-xs">‚úÖ Publi√©</span>
                  )}
                  {(article.status === 'pending' || article.status === 'draft') && (
                    <span class="px-2 py-1 bg-yellow-900/30 text-yellow-400 rounded text-xs">‚è≥ En attente</span>
                  )}
                  {article.status === 'archived' && (
                    <span class="px-2 py-1 bg-red-900/30 text-red-400 rounded text-xs">üì¶ Archiv√©</span>
                  )}
                </td>
                <td class="py-3 px-4 text-sm text-slate-400">
                  {new Date(article.created_at).toLocaleDateString('fr-FR', { 
                    day: '2-digit', 
                    month: 'short', 
                    year: 'numeric' 
                  })}
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
    </div>

    <!-- ANALYTIQUES VISITEURS -->

    <!-- √âvolution des visiteurs par jour -->
    <div class="bg-slate-800 border border-slate-700 rounded-lg p-6 mb-8">
      <h3 class="text-lg font-semibold text-white mb-6">üìà Visiteurs uniques par jour (7 derniers jours)</h3>
      <div class="space-y-4">
        {dailyVisitors.map(day => {
          const maxVisitors = Math.max(...dailyVisitors.map(d => d.visitors));
          const percentage = maxVisitors > 0 ? (day.visitors / maxVisitors) * 100 : 0;
          return (
            <div>
              <div class="flex justify-between text-sm mb-2">
                <span class="text-slate-300">{day.date}</span>
                <span class="text-slate-400">{day.visitors} visiteurs ({day.pageViews} vues)</span>
              </div>
              <div class="w-full bg-slate-700 rounded-full h-3">
                <div
                  class="bg-gradient-to-r from-blue-500 to-cyan-500 h-3 rounded-full transition-all duration-500"
                  style={`width: ${percentage}%`}
                ></div>
              </div>
            </div>
          );
        })}
      </div>
    </div>

    <!-- Sources de trafic et Appareils -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
      <!-- Sources de trafic -->
      <div class="bg-slate-800 border border-slate-700 rounded-lg p-6">
        <h3 class="text-lg font-semibold text-white mb-6">üåê Sources de trafic (7 jours)</h3>
        <div class="space-y-4">
          {trafficSources.map(source => (
            <div>
              <div class="flex justify-between text-sm mb-2">
                <span class="text-slate-300">{source.source}</span>
                <span class="text-slate-400">{source.visitors} ({source.percentage}%)</span>
              </div>
              <div class="w-full bg-slate-700 rounded-full h-2">
                <div
                  class="bg-gradient-to-r from-green-500 to-emerald-500 h-2 rounded-full"
                  style={`width: ${source.percentage}%`}
                ></div>
              </div>
            </div>
          ))}
        </div>
      </div>

      <!-- Appareils utilis√©s -->
      <div class="bg-slate-800 border border-slate-700 rounded-lg p-6">
        <h3 class="text-lg font-semibold text-white mb-6">üì± Appareils utilis√©s (7 jours)</h3>
        <div class="space-y-4">
          {devices.map(device => (
            <div>
              <div class="flex justify-between text-sm mb-2">
                <span class="text-slate-300">{device.device}</span>
                <span class="text-slate-400">{device.visitors} ({device.percentage}%)</span>
              </div>
              <div class="w-full bg-slate-700 rounded-full h-2">
                <div
                  class="bg-gradient-to-r from-purple-500 to-pink-500 h-2 rounded-full"
                  style={`width: ${device.percentage}%`}
                ></div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>

    <!-- Top pages et G√©olocalisation -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
      <!-- Top pages visit√©es -->
      <div class="bg-slate-800 border border-slate-700 rounded-lg p-6">
        <h3 class="text-lg font-semibold text-white mb-6">üìÑ Top pages visit√©es (7 jours)</h3>
        <div class="space-y-3">
          {topPages.map((page, index) => (
            <div class="flex items-center justify-between py-2 border-b border-slate-700 last:border-b-0">
              <div class="flex items-center gap-3">
                <span class="text-lg font-bold text-slate-500 w-6">#{index + 1}</span>
                <div>
                  <p class="text-slate-200 text-sm font-medium line-clamp-1">{page.title}</p>
                  <p class="text-slate-500 text-xs">{page.url}</p>
                </div>
              </div>
              <span class="text-indigo-400 font-semibold">{page.views} vues</span>
            </div>
          ))}
        </div>
      </div>

      <!-- G√©olocalisation -->
      <div class="bg-slate-800 border border-slate-700 rounded-lg p-6">
        <h3 class="text-lg font-semibold text-white mb-6">üåç G√©olocalisation (7 jours)</h3>
        <div class="space-y-4">
          {topCountries.map(country => (
            <div>
              <div class="flex justify-between text-sm mb-2">
                <span class="text-slate-300">{country.country}</span>
                <span class="text-slate-400">{country.visitors} ({country.percentage}%)</span>
              </div>
              <div class="w-full bg-slate-700 rounded-full h-2">
                <div
                  class="bg-gradient-to-r from-orange-500 to-red-500 h-2 rounded-full"
                  style={`width: ${country.percentage}%`}
                ></div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>

  </div>
</AdminLayout>
